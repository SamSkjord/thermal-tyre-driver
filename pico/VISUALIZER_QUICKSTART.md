# Visualizer Quick Start Guide

Quick guide to get the thermal tyre visualizer running on your Mac.

## Prerequisites

- Pico connected via USB running thermal tyre sensor code
- Python 3.7+ installed on your Mac
- Pico sending JSON data over serial

## Installation (One-Time)

```bash
cd thermal-tyre-driver/pico

# Install required packages
pip3 install -r requirements_visualizer.txt
```

## Running

### Option 1: Auto-detect (Easiest)
```bash
python3 visualizer.py
```

The visualizer will automatically find your Pico and start displaying data.

### Option 2: Manual Port Selection
```bash
# List available ports
python3 visualizer.py --list

# Use specific port
python3 visualizer.py -p /dev/tty.usbmodem14201
```

## What You'll See

A window with 6 panels:

1. **Top Left**: Current temperature bars (L/C/R)
   - Color changes with temperature
   - Values shown on bars

2. **Top Right**: Temperature history graph
   - Shows trends over time
   - 3 lines (Left, Centre, Right)

3. **Middle Left**: Confidence meter
   - Green = good detection (>80%)
   - Orange = medium (50-80%)
   - Red = poor (<50%)

4. **Middle Right**: Temperature profile
   - Shows all 32 sensor pixels
   - Red shaded area = detected tyre

5. **Bottom Left**: Lateral gradient
   - Temperature difference across tyre
   - High gradient (>10¬∞C) = uneven heating

6. **Bottom Right**: Status panel
   - Frame count
   - Warnings
   - Statistics

## Troubleshooting

### "No Pico device found"
1. Check USB connection
2. List ports: `python3 visualizer.py --list`
3. Specify port manually: `python3 visualizer.py -p /dev/tty.usbmodem14201`

### "Permission denied" on macOS
```bash
# Add your user to dialout group (may need to logout/login)
sudo dscl . -append /Groups/_uucp GroupMembership $USER
```

### No data appearing
1. Check Pico is running sensor code (not REPL)
2. Verify Pico is sending to correct serial channel
3. Check `boot.py` has `usb_cdc.enable(console=True, data=True)`
4. Try the data port: `/dev/tty.usbmodem14201` vs `/dev/tty.usbmodem14203`

### Slow/choppy visualization
```bash
# Reduce history length
python3 visualizer.py --history 50
```

## Tips

- **Point at hot object** (your hand) to test sensor
- **Check confidence meter** - should be >80% when viewing tyre
- **Watch temperature history** - should be stable if sensor is stationary
- **Monitor warnings** - tells you about detection issues
- **Leave running during testing** - great for debugging

## Keyboard Shortcuts

- **Close window or Ctrl+C**: Exit visualizer
- **Cmd+Q**: Quit (macOS)

## Integration with Pico Code

The visualizer expects JSON in this format:
```json
{
  "frame_number": 42,
  "analysis": {
    "left": {"avg": 45.2, ...},
    "centre": {"avg": 48.5, ...},
    "right": {"avg": 44.8, ...},
    "lateral_gradient": 3.3
  },
  "detection": {
    "confidence": 0.85,
    "span_start": 8,
    "span_end": 24
  },
  "temperature_profile": [23.1, 23.4, ...],
  "warnings": ["High gradient: 12.3¬∞C"]
}
```

This is automatically generated by `serial.send_data(data)` in your Pico code.

## Common Use Cases

### Testing Detection Algorithm
1. Start visualizer
2. Point sensor at different surfaces
3. Watch confidence meter and tyre span highlight

### Monitoring During Development
1. Start visualizer
2. Make code changes on Pico
3. Watch temperatures in real-time as you test

### Recording Data
The visualizer shows live data but doesn't record. To record:
```bash
# On Mac, capture serial to file
screen -L /dev/tty.usbmodem14201 115200
# or
cat /dev/tty.usbmodem14201 > data.jsonl
```

Then visualizer can run simultaneously on a different port.

## Advanced Options

```bash
# Custom baud rate
python3 visualizer.py -b 921600

# More history (uses more CPU)
python3 visualizer.py --history 200

# Combine options
python3 visualizer.py -p /dev/tty.usbmodem14201 -b 115200 --history 100
```

## Next Steps

Once you have the visualizer running:
1. Test with known temperatures (ice, hot water)
2. Verify detection by pointing at different objects
3. Check warnings make sense
4. Monitor during actual tyre measurements

Happy monitoring! üî•‚ùÑÔ∏è
